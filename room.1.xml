<?xml version="1.0" encoding="UTF-8"?>
<refentry id="room.1">

<refmeta>
<refentrytitle>room</refentrytitle>
<manvolnum>1</manvolnum>
</refmeta>

<refnamediv>
<refname>room</refname>
<refpurpose>manage rooms</refpurpose>
</refnamediv>

<refsect1><title>SYNOPSIS</title>

<para>
<literallayout>
<emphasis role="bold">room list</emphasis>
<emphasis role="bold">room</emphasis> <replaceable>name</replaceable> <emphasis role="bold">create</emphasis> [--uri <replaceable>URI</replaceable>]
<emphasis role="bold">room</emphasis> <replaceable>name</replaceable> <emphasis role="bold">destroy</emphasis>
<emphasis role="bold">room</emphasis> <replaceable>name</replaceable> <emphasis role="bold">enter</emphasis>
<emphasis role="bold">room</emphasis> <replaceable>name</replaceable> <emphasis role="bold">exec</emphasis> [-u <replaceable>user</replaceable>] <emphasis role="bold">--</emphasis> <replaceable>command [arguments]</replaceable>
<emphasis role="bold">room</emphasis> <replaceable>name</replaceable> <emphasis role="bold">snapshot</emphasis> <replaceable>snapshot-name</replaceable> create
<emphasis role="bold">room</emphasis> <replaceable>name</replaceable> <emphasis role="bold">snapshot</emphasis> <replaceable>snapshot-name</replaceable> destroy
<emphasis role="bold">room</emphasis> <replaceable>name</replaceable> <emphasis role="bold">snapshot list</emphasis>
<emphasis role="bold">room</emphasis> <replaceable>name</replaceable> <emphasis role="bold">receive</emphasis>
<emphasis role="bold">room</emphasis> <replaceable>name</replaceable> <emphasis role="bold">send</emphasis>
<emphasis role="bold">room</emphasis> <replaceable>name</replaceable> <emphasis role="bold">start</emphasis>
<emphasis role="bold">room</emphasis> <replaceable>name</replaceable> <emphasis role="bold">stop</emphasis>
</literallayout>
</para>
</refsect1>


<refsect1><title>Description</title>
<para>
The <command>room</command> command is the management utility
for rooms. Rooms are a simplified form of containers that are
built on top of ZFS and FreeBSD jails.
</para>

<para>
The following subcommands and options are available:
</para>
	
<variablelist>

	<varlistentry>
		<term>
<literallayout>
<emphasis role="bold">room list</emphasis>
</literallayout>
		</term>
	
		<listitem>
			<para>
	List all existing rooms. The name of each room will be printed, one per line.
			</para>
		</listitem>
	</varlistentry>


	<varlistentry>
		<term>
<literallayout>
<emphasis role="bold">room</emphasis> <replaceable>name</replaceable> <emphasis role="bold">create</emphasis>
</literallayout>
		</term>
	
		<listitem>
			<para>
	Create a new room called <replaceable>name</replaceable>.
	If the <replaceable>--uri</replaceable> option is provided, the URI will be
	downloaded and extracted into the root filesystem of the room.
	If no URI is provided, the default template will be used. 
	If there is no default template, one will be created automatically 
	using a minimal	installation of FreeBSD 10.3.
			</para>
		</listitem>
	</varlistentry>

	<varlistentry>
		<term>
<literallayout>
<emphasis role="bold">room</emphasis> <replaceable>name</replaceable> <emphasis role="bold">destroy</emphasis>
</literallayout>
		</term>
	
		<listitem>
			<para>
	Permanently delete the room called <replaceable>name</replaceable>. All processes running
	in the room will be forcefully terminated. The data for the room will be removed.
			</para>
		</listitem>
	</varlistentry>	

	<varlistentry>
		<term>
<literallayout>
<emphasis role="bold">room</emphasis> <replaceable>name</replaceable> <emphasis role="bold">enter</emphasis>
</literallayout>
		</term>
	
		<listitem>
			<para>
	Invoke a login shell inside the room called <replaceable>name</replaceable>.
			</para>
		</listitem>
	</varlistentry>	

	<varlistentry>
		<term>
<literallayout>
<emphasis role="bold">room</emphasis> <replaceable>name</replaceable> <emphasis role="bold">exec</emphasis> [-u <replaceable>user</replaceable>] <emphasis role="bold">--</emphasis> <replaceable>command [arguments]</replaceable>
</literallayout>
		</term>
	
		<listitem>
			<para>
	Execute the given <replaceable>command</replaceable> inside the room called <replaceable>name</replaceable>.
	By default, commands will be executes as the current user. To run commands as a different user
	pass the <replaceable>-u</replaceable> or <replaceable>--user</replaceable> option along with the name or numeric ID of the user.
	To avoid confusion, it is recommended to use -- to signify the start of the command(s) to be executed.
			</para>
		</listitem>
	</varlistentry>	

	<varlistentry>
		<term>
<literallayout>
<emphasis role="bold">room</emphasis> <replaceable>name</replaceable> <emphasis role="bold">start</emphasis>
</literallayout>
		</term>
	
		<listitem>
			<para>
	Start up a room with the given <replaceable>name</replaceable>.
	Currently, this will mount filesystems and create a jail. In the future,
	support will be added for starting programs automatically within the room. 
			</para>
		</listitem>
	</varlistentry>	

	<varlistentry>
		<term>
<literallayout>
<emphasis role="bold">room</emphasis> <replaceable>name</replaceable> <emphasis role="bold">receive</emphasis>
</literallayout>
		</term>
	
		<listitem>
			<para>
	Create a room with the given <replaceable>name</replaceable> from
	a streaming archive provided over standard input. The archive must
	be created by running the "room send" command. 
	This behaves similar to the "zfs receive" command. 
			</para>
		</listitem>
	</varlistentry>	

	<varlistentry>
		<term>
<literallayout>
<emphasis role="bold">room</emphasis> <replaceable>name</replaceable> <emphasis role="bold">send</emphasis>
</literallayout>
		</term>
	
		<listitem>
			<para>
	Create a streaming archive of a room with the given <replaceable>name</replaceable> and 
	send it to standard output. This behaves similar to the "zfs send" command. 
			</para>
		</listitem>
	</varlistentry>	

	
		<varlistentry>
		<term>
<literallayout>
<emphasis role="bold">room</emphasis> <replaceable>name</replaceable> <emphasis role="bold">stop</emphasis>
</literallayout>
		</term>
	
		<listitem>
			<para>
	Terminate all processes inside the room called <replaceable>name</replaceable>,
	unmount all mounted filesystems in the room, and destroy the associated jail. 
			</para>
		</listitem>
	</varlistentry>	
	
</variablelist>

</refsect1>

<refsect1>
	<title>EXAMPLES</title>
	<para>
	The following example creates a new room named FreeBSD-10.3 by downloading
	the base.txz file from the closest FreeBSD mirror. 
	</para>
	<programlisting>
<![CDATA[
$ room FreeBSD-10.3 create \
    --uri=ftp://ftp.freebsd.org/pub/FreeBSD/releases/amd64/10.3-RELEASE/base.txz
]]>
	</programlisting>

	<para>
	The following example creates a TrueOS room named 'TrueOS'.
	</para>
	<programlisting>
	<![CDATA[
$ room TrueOS create --uri=http://download.trueos.org/master/amd64/dist/base.txz
]]>
	</programlisting>
	
	<para>
	To copy a room called "FreeBSD-10.3" to a remote server named "myhost".
	</para>
	<programlisting>
<![CDATA[
$ room FreeBSD-10.3 send | ssh myhost room receive FreeBSD-10.3
]]>
	</programlisting>
	
</refsect1>

<refsect1>
	<title>ENVIRONMENT</title>
	<para>
	The <command>room</command> command does not rely on any environment variables.
	</para>
</refsect1>

<refsect1>
	<title>EXIT STATUS</title>
	<para>
	The <command>room</command> command exits 0 on success, and >0 if an error occurs
	</para>
</refsect1>

<!--
<refsect1>
	<title>SEE ALSO</title>
	<para>
	<citerefentry><refentrytitle>jobadm</refentrytitle><manvolnum>1</manvolnum></citerefentry>
	<citerefentry><refentrytitle>jobcfg</refentrytitle><manvolnum>1</manvolnum></citerefentry>
	<citerefentry><refentrytitle>jobd</refentrytitle><manvolnum>8</manvolnum></citerefentry>
	<citerefentry><refentrytitle>job</refentrytitle><manvolnum>5</manvolnum></citerefentry>
	</para>
</refsect1>
-->

<refsect1>
	<title>AUTHORS</title>
	<para>
		Mark Heily &lt;mark@heily.com&gt;
	</para>
</refsect1>

<refsect1>
	<title>BUGS</title>
	
	<para>
	Sending and receiving rooms will not work as expected if you are operating on
	rooms which are cloned from the base template. For best results,	only send rooms that are created via "room create --uri=base.txz". 
	</para>
	
	<para>
	The snapshot subcommands are not documented in this manual page.
	</para>
</refsect1>

</refentry>
